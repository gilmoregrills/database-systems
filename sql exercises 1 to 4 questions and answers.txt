EXERCISE 1 SQL
 
1 LIST ALL EMPLYEES WHOSE SALARY IS BETWEEN 1,000 AND 2,000. SHOW 
employee NAME, DEPARTMENT AND SALARY
 
2 DISPLAY ALL THE DIFFERENT TYPES OF OCCUPATIONS
 
3 LIST DETAILS OF EMPLOYEES IN DEPARTMENTS 10 AND 30
 
4 DISPLAY ALL EMPLOYEES WHO RECRUITED DURING 1982, GIVING THEIR 
NAME, DEPARTMENT AND HIREDATE.
 
5 LIST THE EMPLOYEES WHOSE NAMES HAVE 'TH' OR 'LL' IN THEM
 
6 LIST THE DEPARTMENT NUMBERS AND NAMES IN DEPARTMENT NAME ORDER
 
7 FIND THE NAMES, JOBS, SALARIES AND COMMISSIONS OF ALL EMPLOYEES 
WHO DO NOT HAVE MANAGERS
 
8 LIST ALL SALESMEN IN DESCENDING ORDER OF THEIR 
COMMISSION DIVIDED BY THEIR SALARY
 
9 CALCULATE THE TOTAL ANNUAL COMPENSATION OF ALL SALESMEN BASED 
UPON THEIR MONTHLY SALARY AND MONTHLY COMMISSION
 
(SAL+COMM)*12
 
10 FIND ALL THE SALESMEN IN DEPARTMENT 30 WHO HAVE A SALARY 
GREATER THAN OR EQUAL TO $1,500
 
 
EXERCISE 1 - SQL ANSWER SHEET
 
1. SELECT ENAME, DEPTNO, SAL FROM EMP
WHERE SAL BETWEEN 1000 AND 2000 ;
 
2. SELECT DISTINCT JOB FROM EMP ;
 
3. SELECT * FROM EMP
WHERE DEPTNO = ANY ( 10, 30 ) ;
 
4. SELECT ENAME, DEPTNO, HIREDATE FROM EMP
WHERE HIREDATE BETWEEN '01-JAN-82
 AND '31-DEC-82' ;
 
5. SELECT ENAME FROM EMP
WHERE ENAME LIKE '%TH% ' OR ENAME LIKE '%LL% '
 
6. SELECT DEPTNO, DNAME FROM DEPT
ORDER BY DNAME ;
 
7. SELECT ENAME, JOB, SAL, COMM FROM EMP
WHERE MGR IS NULL ;
 
 
8. SELECT ENAME, COMM/SAL, COMM, SAL FROM EMP
WHERE JOB = ' SALESMAN ' ORDER BY COMM/SAL DESC ;
 
9. SELECT ENAME, SAL, COMM, ( SAL + COMM )* 12 FROM EMP
WHERE JOB = 'SALESMAN ' ;
 
10. SELECT ENAME, SAL, DEPTNO FROM EMP
WHERE JOB = ' SALESMAN ' AND DEPTNO = 30 AND SAL >= 1500;
 
 
 
EXERCISE 2: FUNCTIONS
 
1) FIND OUT HOW MANY MANAGERS THERE ARE WITHOUT LISTING THEM. 
3.
 
2) COMPUTE THE AVERAGE ANNUAL SALARY + COMMISSION FOR ALL 
SALESMAN
AVG(SAL+COMM)*12 23,400
 
3) FIND THE HIGHEST AND LOWEST PAID EMPLOYEES AND THE DIFFERENCE 
BETWEEN THEM
MAX(SAL) 5,000
MIN(SAL) 800
MAX(SAL)-MIN(SAL) 4200
 
4) FIND THE NUMBER OF CHARACTERS IN THE LONGEST DEPARTMENT NAME
MAX(LENGTH(DNAME)) 10
 
5) COUNT THE NUMBER OF PEOPLE IN DEPARTMENT 30 WHO RECEIVE 
A SALARY AND THE NUMBER OF PEOPLE WHO RECEIVE A COMMISSION
COUNT(SAL) 6
COUNT(COMM) 4
 
6) LIST THE AVERAGE COMMISSION OF EMPLOYEES WHO RECEIVE A 
COMMISSION AND THE AVERAGE COMMISSION OF ALL EMPLOYEES (TREATING 
EMPLOYEES WHO DO NOT RECEIVE A COMMISSION AS RECEIVING A ZERO 
COMMISSION)
AVG(COMM) 550
AVG(NVL(COMM,0))
366,666667
 
7) LIST THE AVERAGE SALARY OF EMPLOYEES THAT RECEIVE A SALARY, 
THE AVERAGE COMMISSION OF EMPLOYEES THAT RECEIVE A COMMISSION, 
THE AVERAGE SALARY PLUS COMMISSION OF ONLY THOSE EMPLOYEES THAT 
RECEIVE A COMMISSION AND AVERAGE SALARY PLUS COMMISSION OF ALL 
EMPLOYEES INCLUDING THOSE WHO DO NOT RECEIVE A COMMISSION
AVG(SAL) 1,566.67
AVG(COMM) 550.00
AVG(SAL+COMM) 1,950.00
AVG(SAL+NVL(COMM,0)) 1,933.23
 
8) COMPUTE THE DAILY AND HOURLY SALARIES FOR EMPLYEES 
IN DEPARTMENT 30. ROUND THE RESULTS TO THE NEAREST PENNY. ASSUME 
THERE ARE 22 WORKING DAYS IN A MONTH AND 8 WORKING HOURS IN A DAY.
 
9) ISSUE THE SAME QUERY AS THE PREVIOUS ONE EXCEPT THAT THIS TIME 
TRUNCATE (TRUNC) TO THE NEAREST PENNY RATHER THAN ROUND.


EXERCISE 2 FUNCTIONS ANSWER SHEET
 
1. SELECT COUNT (JOB ) "MANAGERS" FROM EMP
WHERE JOB = 'MANAGER ' ;
 
2. SELECT AVG (SAL+COMM ) * 12
FROM EMP
WHERE JOB = ' SALESMAN ' ;
 
3. SELECT MAX ( SAL), MIN ( SAL ), MAX ( SAL ) - MIN ( SAL )
FROM EMP ;
 
4. SELECT MAX (LENGTH ( DNAME ) )
FROM DEPT ;
 
5. SELECT COUNT (SAL ), COUNT(COMM )
FROM EMP WHERE DEPTNO = 30 ;
 
6. SELECT AVG ( COMM ), AVG (NVL (COMM, 0 ) ) FROM EMP WHERE 
DEPTNO = 30 ;
 
7. SELECT AVG ( SAL, AVG ( COMM ), AVG( SAL+COMM ), 
AVG(SAL+NVL(COMM, 0
) ) FROM EMP WHERE DEPTNO = 30 ;
 
8. SELECT ENAME, SAL MONTHLY, ROUND ( SAL/22, 2 ) DAILY,ROUND ( 
SAL/ ( 22* 8 ), 2 ) HOURLY FROM EMP
WHERE DEPTNO = 30 ;
 
9. SELECT ENAME, SAL MONTHLY, TRUNC ( SAL/22, 2 ) DAILY,TRUNC ( 
SAL/ ( 22 * 8 ), 2 ) HOURLY FROM EMP
WHERE DEPTNO = 30 ;
 
EXERCISE 3: DATES
 
1) SELECT THE NAME, JOB AND HIREDATE OF THE EMPLOYEES IN DEPT 20 
(FORMAT THE HIREDATE COLUMN USING A PICTURE OF MM/DD/YY)
 
2) USE A PICTURE TO FORMAT HIREDATE AS: DAY (DAY OF THE WEEK), 
MONTH (NAME OF THE MONTH), DD (DAY OF THE MONTH) AND YYYY (YEAR). 
E.G. WEDNESDAYJANUARY THE 12TH, 1983
 
3) USE THE FORMAT MASK SUFFIX 'TH' IN A PICTURE (ORACLE WILL PUT 
A SUFFIX AFTER THE FIELD (DDTH).)
 
4) SELECT THE NAME AND HIREDATE OF DEPARTMENT 20'S EMPLOYEES IN 
THE FOLLOWING FORMAT:
 
ENAME, HIREDATE
ADAMS, JANUARY 12TH, 1983, 11:05 AM
 
 
 
EXERCISE 3 - DATES ANSWER SHEET
 
NOTE: BY DEFAULT DATE FIELDS IN ORACLE ARE OUTPUT WITH 
72 CHARACTERS WIDTH, TO ALTER THIS YOU USE THE SQLPLUS 
COLUMN STATEMENT, E.G.:
 
COLUMN HIREDATE FORMAT A45
 
 
1. SELECT ENAME, JOB, TO_CHAR ( HIREDATE, ' MM/DD/YY ' ) HIREDATE 
FROM EMP
WHERE DEPTNO = 20 ;
 
 
2. SELECT ENAME, JOB, TO_CHAR ( HIREDATE, ' DAY, MONTH, DD, YYYY 
' ) HIREDATE
FROM EMP WHERE DEPTNO = 20 ;
 
3. SELECT ENAME, JOB, TO_CHAR ( HIREDATE, ' DAY DDTH MONTH YYYY ' 
) HIREDATE
FROM EMP WHERE DEPTNO = 20 ;
 
 
 
4. SELECT ENAME, TO_CHAR ( HIREDATE, ' MONTH DD, YYYY HH : MIPM ' 
) HIREDATE
FROM EMP WHERE DEPTNO = 20 ;
 
 
 
 
EXERCISE 4: JOINES
 
1) FIND THE NAME AND SALARY OF EMPLOYEES IN DALLAS
 
2) JOIN THE DEPT TABLE TO THE EMP TABLE AND SHOW IN DEPARTMENT 
NUMBER ORDER
 
3) LIST ALL DEPARTMENTS THAT HAVE EMPLOYEES PLUS THOSE 
DEPARTMENTS THAT DO NOT HAVE EMPLOYEES
 
4) LIST ALL DEPARTMENTS THAT DO NOT HAVE ANY EMPLOYEES
 
5) FIND ALL THE EMPLOYEES THAT EARN MORE THAN JONES 
USINGTEMPORARY LABELS TO ABREVIATE TABLE NAMES
 
6) FOR EACH EMPLOYEE WHOSE SALARY EXCEEDS HIS MANAGER'S SALARY 
LIST THE EMPLOYEE'S NAME AND A SALARY AND THE MANAGER'S NAME AND 
SALARY
 
 
 
EXERCISE 4 - JOINS ANSWER SHEET
 
1. SELECT ENAME, SAL, LOC FROM EMP, DEPT
WHERE EMP. DEPTNO = DEPT. DEPTNO AND LOC = ' DALLAS ' :
 
 
 
2. SELECT DEPT .DEPTNO, DNAME, JOB, ENAME FROM DEPT, EMP
WHERE DEPT .DEPTNO = EMP .DEPTNO ORDER BY DEPT. DEPTNO ;
 
 
3. SELECT DEPT .DEPTNO, DNAME, JOB, ENAME FROM DEPT, EMP
WHERE DEPT ,DEPTNO = EMP. DEPTNO ( + ) ORDER BY DEPT. DEPTNO ;
 
4. SELECT DISTINCT DEPT. DEPTNO, DNAME, LOC FROM DEPT, EMP
WHERE DEPT .DEPTNO = EMP. DEPTNO ( + )
AND EMPNO IS NULL ;
 
 
5. SELECT X. ENAME, X. SAL, X. JOB, Y. ENAME, Y. SAL, Y. JOB 
FROM EMP X, EMP Y
WHERE X. SAL > Y .SAL
AND Y .ENAME = 'JONES ' ;
 
 
6. SELECT WORKER. ENAME, WORKER. SAL, MANAGER. ENAME,MANAGER. SAL 
FROM EMP WORKER, EMP MAMAGER
WHERE WORKER. MGR = MANAGER. EMPNO AND WORKER .SAL > MANAGER .SAL 
;
 
 